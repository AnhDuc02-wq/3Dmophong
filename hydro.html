<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mô phỏng nguyên tử Hydro</title>
    <!-- Mô phỏng cấu trúc nguyên tử Hydro sử dụng Babylon.js -->
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/gui/babylon.gui.min.js"></script>
    <style>/* Thêm CSS cho thanh kéo */
        #sliderContainer {
            position: absolute;
            right: 10px;
            bottom: 10%;
            width: 50px;
            height: 300px;
            text-align: center;
        }
    </style>

</head>
<body>
    <canvas id="renderCanvas" style="width: 100%; height: 100vh;"></canvas>
    <div id="tooltip" style="position: absolute; top: 10px; left: 10px; background-color: rgba(255, 255, 255, 0.8); padding: 10px; border-radius: 5px; display: none;">
        <h3>Hydro (H):</h3>
        <ul>
            <li>Hình dạng :	Khí không màu, sẽ phát sáng với ánh sáng tím khi chuyển sang thể plasma</li>
            <li>Số hiệu nguyên tử (Z) : 1 	</li>
            <li>Khối lượng nguyên tử chuẩn (±) (Ar) :1,00794 (1.00784–1.00811)</li>
            <li>Phân loại : Phi kim</li>
            <li>Nhóm, phân lớp 	1, s</li>
            <li>Chu kỳ : 1</li>
            <li>Cấu hình electron :  1s1</li>
        </ul>
    
    <script>
        // Khởi tạo scene
        const canvas = document.getElementById("renderCanvas");
        const engine = new BABYLON.Engine(canvas, true);
        const scene = new BABYLON.Scene(engine);

        // Tạo camera
        const camera = new BABYLON.ArcRotateCamera("camera", Math.PI / 2, Math.PI / 2, 10, BABYLON.Vector3.Zero(), scene);
        camera.attachControl(canvas, true);

        // Tạo ánh sáng
        const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(1, 1, 0), scene);

        // Tạo hạt nhân của nguyên tử (hình cầu ở trung tâm)
        const nucleus = BABYLON.MeshBuilder.CreateSphere("nucleus", {diameter: 1}, scene);
        nucleus.material = new BABYLON.StandardMaterial("nucleusMat", scene);
        nucleus.material.diffuseColor = new BABYLON.Color3(1, 0, 0); // Màu đỏ

        // Tạo hình cầu lớn để bao quanh và chứa electron
        const outerSphere = BABYLON.MeshBuilder.CreateSphere("outerSphere", {diameter: 4, sideOrientation: BABYLON.Mesh.DOUBLESIDE}, scene);
        outerSphere.material = new BABYLON.StandardMaterial("outerSphereMat", scene);
        outerSphere.material.alpha = 0.1; // Làm cho hình cầu bao quanh mờ đi

        // Tạo vòng tròn chia đôi hình cầu
        const circlePath = [];
        const circleRadius = 2;
        const deltaTheta = 0.05;

        for(let theta = 0; theta <= 2 * Math.PI; theta += deltaTheta) {
            circlePath.push(new BABYLON.Vector3(circleRadius * Math.cos(theta), 0, circleRadius * Math.sin(theta)));
        }

        circlePath.push(circlePath[0]);

        const curve = BABYLON.Curve3.CreateCatmullRomSpline(circlePath, 60, true);
        const dividingCircle = BABYLON.MeshBuilder.CreateLines("dividingCircle", {points: curve.getPoints()}, scene);
        dividingCircle.color = new BABYLON.Color3(1, 1, 1); // Màu trắng

        // Tạo electron (hình cầu nhỏ màu xanh lá)
        const electron = BABYLON.MeshBuilder.CreateSphere("electron", {diameter: 0.2}, scene);
        electron.material = new BABYLON.StandardMaterial("electronMat", scene);
        electron.material.diffuseColor = new BABYLON.Color3(0, 1, 0); // Màu xanh lá

        // Vị trí ban đầu của electron
        electron.position.x = circleRadius;

        // Animation cho electron xoay quanh vòng tròn chia đôi hình cầu
        scene.registerBeforeRender(function() {
            const time = performance.now() * 0.002;
            electron.position.x = circleRadius * Math.cos(-time);
            electron.position.z = circleRadius * Math.sin(-time);
        });


        // Khởi tạo mảng để lưu trữ vị trí của luồng dẫn
const trailPositions = [];
const maxTrailLength = 50;

// Tạo đối tượng để vẽ luồng dẫn
let trail;

// Hàm cập nhật và hiển thị luồng dẫn
function updateTrail() {
    // Thêm vị trí hiện tại của electron vào mảng
    trailPositions.push(electron.position.clone());
    
    // Giới hạn độ dài của luồng dẫn
    if (trailPositions.length > maxTrailLength) {
        trailPositions.shift();
    }
    
    // Xóa luồng dẫn cũ nếu có
    if (trail) {
        trail.dispose();
    }
    
    // Tạo luồng dẫn mới
    trail = BABYLON.MeshBuilder.CreateLines("trail", {points: trailPositions}, scene);
    trail.color = new BABYLON.Color3(0, 1, 0); // Màu xanh lá
}

// Cập nhật vị trí electron và luồng dẫn trong mỗi khung hình
scene.registerBeforeRender(function() {
    const time = performance.now() * 0.002;
    electron.position.x = circleRadius * Math.cos(-time);
    electron.position.z = circleRadius * Math.sin(-time);
    
    updateTrail();
});


        // Render loop
        engine.runRenderLoop(() => {
            scene.render();
        });

        // Resize khi thay đổi kích thước màn hình
        window.addEventListener("resize", () => {
            engine.resize();
        });

        // Toggle tooltip visibility on mouse click
        const tooltip = document.getElementById("tooltip");
        canvas.addEventListener("click", () => {
            tooltip.style.display = tooltip.style.display === "none" ? "block" : "none";
        });

        // **Thêm thanh kéo dọc để điều chỉnh thu/phóng**
        const slider = new BABYLON.GUI.Slider();
        slider.minimum = 5;
        slider.maximum = 20;
        slider.value = 10;
        slider.height = "200px";
        slider.width = "20px";
        slider.isVertical = true;
        slider.color = "green";
        slider.background = "gray";
        slider.onValueChangedObservable.add(function (value) {
            scene.activeCamera.radius = value; // Điều chỉnh khoảng cách camera
        });

        const advancedTextureSlider = BABYLON.GUI.AdvancedDynamicTexture.CreateFullscreenUI("UI");
        advancedTextureSlider.addControl(slider);

        slider.verticalAlignment = BABYLON.GUI.Control.VERTICAL_ALIGNMENT_BOTTOM;
        slider.horizontalAlignment = BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_RIGHT;
        slider.left = -30;
        slider.top = -30;

    </script>
</body>
</html>